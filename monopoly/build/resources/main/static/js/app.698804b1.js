(function(t){function e(e){for(var a,n,i=e[0],c=e[1],l=e[2],p=0,d=[];p<i.length;p++)n=i[p],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],a=!0,i=1;i<r.length;i++){var c=r[i];0!==s[c]&&(a=!1)}a&&(o.splice(e--,1),t=n(n.s=r[0]))}return t}var a={},s={app:0},o=[];function n(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=a,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[r("div",{staticClass:"d-flex align-center"},[r("h1",[t._v(" Monopoly Online ")])]),r("v-spacer"),t.userName?t._e():r("v-btn",{attrs:{href:"http://localhost:8080/login",text:""}},[r("span",{staticClass:"mr-2"},[t._v("Вход")]),r("v-icon",[t._v("mdi-open-in-new")])],1)],1),r("v-main",{staticStyle:{"background-color":"rgb(242, 242, 242)"}},[r("router-view")],1)],1)},o=[],n=r("1da1"),i=(r("96cf"),r("b0c0"),{name:"App",data:function(){return{userName:null}},methods:{isLogged:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/profile");case 2:r=e.sent,t.userName=r.data.name;case 4:case"end":return e.stop()}}),e)})))()}},created:function(){this.isLogged()}}),c=i,l=r("2877"),u=r("6544"),p=r.n(u),d=r("7496"),v=r("40dc"),h=r("8336"),m=r("132d"),f=r("f6c4"),g=r("2fa4"),y=Object(l["a"])(c,s,o,!1,null,null,null),b=y.exports;p()(y,{VApp:d["a"],VAppBar:v["a"],VBtn:h["a"],VIcon:m["a"],VMain:f["a"],VSpacer:g["a"]});var w=r("8c4f"),x=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-row",[r("v-col",[t.userName?r("div",[r("v-container",[r("br"),r("v-row",[r("v-col",{attrs:{cols:"3"}},[r("v-card",{attrs:{elevation:"3"}},[r("v-card-title",{staticClass:"justify-center",staticStyle:{width:"100%"}},[t._v(" Создать комнату ")]),r("v-form",{attrs:{disabled:t.currentRoom}},[r("v-text-field",{staticClass:"mx-auto",staticStyle:{width:"80%"},attrs:{counter:20,label:"Название",required:""},model:{value:t.newRoomName,callback:function(e){t.newRoomName=e},expression:"newRoomName"}}),r("v-select",{staticClass:"mx-auto",staticStyle:{width:"80%"},attrs:{items:[2,3,4],label:"Кол-во игроков",required:""},model:{value:t.playersNumber,callback:function(e){t.playersNumber=e},expression:"playersNumber"}}),r("br"),t.currentRoom?t._e():r("v-btn",{staticClass:"mr-4",attrs:{width:"100%",color:"blue",dark:""},on:{click:t.createRoom}},[r("b",[t._v("Создать")])])],1)],1)],1),r("v-col",{attrs:{cols:"6"}},[r("v-card",{attrs:{elevation:"3"}},[r("v-card-title",{staticClass:"justify-center",staticStyle:{width:"100%"}},[t._v(" Ожидают игры ")]),r("v-list",t._l(t.rooms,(function(e){return r("v-list-item",{key:e.id,staticClass:"pa-2"},[r("v-card",{staticStyle:{"background-color":"#d7e7f7"},attrs:{width:"100%",elevation:"0"}},[r("v-row",[r("v-col",[r("v-card-title",[t._v(" "+t._s(e.name)+" ")])],1),r("v-col",[r("v-btn",{staticClass:"mr-4 py-5 my-4",staticStyle:{float:"right"},attrs:{color:"blue",dark:!t.currentRoom,disabled:t.currentRoom},on:{click:function(r){return t.joinRoom(e.id)}}},[r("b",[t._v("Присоедениться")])])],1)],1)],1)],1)})),1)],1)],1),r("v-col",{staticStyle:{"max-width":"300px"},attrs:{cols:"3"}},[r("v-card",{attrs:{elevation:"3"}},[r("v-card-title",{staticClass:"justify-center",staticStyle:{width:"100%"}},[t._v(" Профиль ")]),r("v-list",[r("v-list-item",[r("v-list-item-title",[r("b",[t._v("Имя:")]),t._v(" "+t._s(t.userName)+" ")])],1),r("v-list-item",[r("v-list-item-title",[r("b",[t._v("Всего игр:")]),t._v(" "+t._s(t.totalGames)+" ")])],1),r("v-list-item",[r("v-list-item-title",[r("b",[t._v("Побед:")]),t._v(" "+t._s(t.totalWins)+" ")])],1),r("v-list-item",[r("v-list-item-title",[r("b",[t._v("Поражений:")]),t._v(" "+t._s(t.totalLoses)+" ")])],1),r("v-list-item",[r("v-btn",{staticClass:"mr-4",attrs:{width:"100%",color:"blue",dark:"",disabled:!t.currentRoom},on:{click:function(e){return t.$router.push("/game")}}},[r("b",[t._v("Текущая игра")])])],1)],1)],1)],1)],1)],1)],1):r("div",[r("v-container",[r("v-card",{staticClass:"mx-auto my-1",staticStyle:{"background-color":"rgb(242, 242, 242)"},attrs:{width:"500px",elevation:"0"}},[r("h1",[t._v("Пожалуйста, водите в систему")])])],1)],1)])],1)},_=[],k={name:"Main",data:function(){return{userName:null,rooms:null,currentRoom:null,totalGames:null,totalWins:null,totalLoses:null,newRoomName:"",playersNumber:2}},methods:{isLogged:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/profile");case 2:r=e.sent,t.userName=r.data.name,t.currentRoom=r.data.currentRoom,t.totalGames=r.data.totalGames,t.totalLoses=r.data.totalLoses,t.totalWins=r.data.totalWins,r.data.name&&t.getRooms();case 9:case"end":return e.stop()}}),e)})))()},getRooms:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/room");case 2:r=e.sent,t.rooms=r.data;case 4:case"end":return e.stop()}}),e)})))()},createRoom:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.post("/room",{name:t.newRoomName,playersNumber:t.playersNumber});case 2:r=e.sent,200===r.status&&(a=r.data.id,t.currentRoom=a,t.joinRoom(a));case 4:case"end":return e.stop()}}),e)})))()},joinRoom:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.axios.put("/profile",{currentRoom:t});case 2:if(a=r.sent,200!==a.status){r.next=17;break}return r.next=6,e.axios.post("/user_to_room",{id:t});case 6:return r.next=8,e.axios.get("/room/".concat(t));case 8:return s=r.sent,r.next=11,e.axios.get("/user_to_room");case 11:if(o=r.sent,s.data.playersNumber!==o.data.length){r.next=15;break}return r.next=15,e.axios.put("/room/".concat(t));case 15:return r.next=17,e.$router.push("/game");case 17:case"end":return r.stop()}}),r)})))()}},created:function(){this.isLogged()}},P=k,R=r("b0af"),C=r("99d9"),S=r("62ad"),j=r("a523"),V=r("4bd4"),O=r("8860"),N=r("da13"),B=r("5d23"),T=r("0fd9"),L=r("b974"),I=r("8654"),M=Object(l["a"])(P,x,_,!1,null,null,null),$=M.exports;p()(M,{VBtn:h["a"],VCard:R["a"],VCardTitle:C["c"],VCol:S["a"],VContainer:j["a"],VForm:V["a"],VList:O["a"],VListItem:N["a"],VListItemTitle:B["b"],VRow:T["a"],VSelect:L["a"],VTextField:I["a"]});var D=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-row",{staticClass:"my-12",staticStyle:{"min-width":"2000px"}},[r("v-col",{staticClass:"mx-auto pr-12",attrs:{cols:"2"}},[r("div",[r("v-list",{staticClass:"mx-5",staticStyle:{"background-color":"rgb(242, 242, 242)"}},t._l(t.users,(function(e){return r("v-list-item",{key:e.id},[r("v-card",{staticClass:"my-4",attrs:{height:"200px",width:"180px"}},[r("v-card-title",[t._v(" "+t._s(e.user.name)+" ")]),r("v-card-subtitle",{staticClass:"my-auto"},[r("b",[t._v("Баланс: "+t._s(e.money)+"$")])]),r("v-card-text",{staticStyle:{color:"blueviolet"}},[r("b",[t._v(" Позиция: "+t._s(e.position)+" ")]),e.isYourTurn?r("p",{staticStyle:{color:"indianred"}},[r("b",[t._v(" Ходит ")])]):t._e()])],1)],1)})),1)],1)]),r("v-col",{staticStyle:{"max-width":"1050px","margin-right":"100px"},attrs:{cols:"7"}},[r("v-row",{staticClass:"my-0 mx-0",staticStyle:{width:"1000px",height:"750px"}},t._l(t.properties,(function(e){return r("v-col",{key:e.mapPosition,staticClass:"pa-0",staticStyle:{height:"125px"},attrs:{cols:"2"}},[-1!==e.position?r("v-col",{staticClass:"pa-0",staticStyle:{border:"2px solid black",width:"100%",height:"100%"}},[r("v-card",{attrs:{dark:"",color:e.color,width:"100%",height:"100%",rounded:"0",elevation:"0"}},[r("v-card-title",[r("b",[t._v(t._s(e.position)+" - "+t._s(e.name))])]),r("v-card-subtitle",[r("b",[t._v(t._s(e.owner))])]),e.owner?r("v-card-text",[r("b",[t._v("Штраф: "+t._s(e.price/2)+"$")])]):r("v-card-text",[0===e.position?r("b",[t._v(t._s(e.price)+"$")]):r("b",[t._v("Цена: "+t._s(e.price)+"$")])])],1)],1):r("v-col",{staticClass:"pa-0",staticStyle:{width:"100%",height:"100%"}},[r("v-card",{attrs:{dark:"",color:e.color,width:"100%",height:"100%",rounded:"0",elevation:"0"}})],1)],1)})),1)],1),t.isStarted?r("v-col",{staticClass:"pa-0",staticStyle:{"margin-right":"150px"},attrs:{cols:"2"}},[r("div",{staticStyle:{height:"750px"}},[r("v-row",{staticClass:"my-12"},[t.yourTurn?r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{depressed:"",color:"primary",width:"100%",height:"60px"},on:{click:function(e){return t.move()}}},[r("h3",[t._v("Сделать ход ")])])],1):t._e(),t.canBuy?r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{depressed:"",color:"error",width:"100%",height:"60px"},on:{click:function(e){return t.buy()}}},[r("h3",[t._v("Купить")])])],1):t._e(),t.canBuy?r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{depressed:"",dark:"",color:"black",width:"100%",height:"60px"},on:{click:function(e){return t.endMove()}}},[r("h3",[t._v("Закончить ход")])])],1):t._e()],1)],1)]):r("v-col",{staticClass:"pa-0",staticStyle:{"margin-right":"150px"},attrs:{cols:"2"}},[r("div",{staticStyle:{height:"750px"}},[r("v-row",{staticClass:"my-12"},[r("v-col",{attrs:{cols:"12"}},[r("h2",{staticStyle:{"margin-left":"40px"}},[t._v("Ожидание игроков")]),r("br"),r("v-btn",{attrs:{depressed:"",color:"primary",width:"100%",height:"60px"},on:{click:function(e){return t.checkIsStarted()}}},[r("h3",[t._v("Обновить")])])],1)],1)],1)])],1)},G=[],U=r("cc7d"),Y=r.n(U),A=r("c6e1"),E=r.n(A),W={name:"Game",data:function(){return{currentPosition:0,thisPlayer:null,yourTurn:!1,isStarted:!1,canBuy:!1,properties:[],users:[],incomeData:[]}},created:function(){this.getPlayers(),this.getCurrentPlayer(),this.connect(),this.prepProps(),this.fetchProperties()},methods:{getCurrentPlayer:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/profile");case 2:r=e.sent,200===r.status&&(t.thisPlayer=r.data.id);case 4:case"end":return e.stop()}}),e)})))()},checkIsStarted:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t.users[0].user.currentRoom),e.next=3,t.axios.get("/room/".concat(t.users[0].user.currentRoom));case 3:r=e.sent,200===r.status&&(console.log(r.data),t.isStarted=r.data.isStarted),t.getPlayers();case 6:case"end":return e.stop()}}),e)})))()},getPlayers:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/user_to_room");case 2:r=e.sent,200===r.status&&(t.users=r.data,console.log(r.data)),t.isYourTurn();case 5:case"end":return e.stop()}}),e)})))()},isYourTurn:function(){console.log("Died Here"),console.log(this.users);for(var t=0;t<this.users.length;t++){var e=this.users[t];console.log(e),e.user.id===this.thisPlayer&&(this.yourTurn=e.isYourTurn)}console.log("Didn't survive :(")},isYourProperty:function(){for(var t=0;t<this.users.length;t++){var e=this.users[t];if(e.user.id===this.thisPlayer){var r=e.position;if(this.currentPosition=r,this.canBuy=!0,0===r)return void(this.canBuy=!1);for(var a=0;a<this.properties.length;a++){var s=this.properties[a];if(r===s.position){if(this.getPlayerByUserId().user.name===s.owner)return this.canBuy=!1,void this.send(e);if(s.owner){var o=s.price/2,n=this.getPlayerByUserId();return n.money-=o,n.money<0&&(this.isStarted=!1),this.send(n),void(this.canBuy=!1)}}}}}},getPlayerByUserId:function(){for(var t=0;t<this.users.length;t++){var e=this.users[t];if(e.user.id===this.thisPlayer)return e}},getPropertyOwner:function(t){for(var e=0;e<this.users.length;e++)for(var r=this.users[e],a=0;a<r.properties.length;a++){var s=r.properties[a];if(s.id===t)return r}},move:function(){var t=.5+6*Math.random(),e=Math.round(t),r=this.getPlayerByUserId();r.position+=e,r.position>19&&(r.money+=1e3,r.position-=20),this.yourTurn=!1,this.isYourProperty()},endMove:function(){var t=this.getPlayerByUserId();this.send(t),this.canBuy=!1},buy:function(){console.log("Bought");for(var t=0;t<this.properties.length;t++){var e=this.properties[t];if(console.log(this.currentPosition),console.log(e.position),e.position===this.currentPosition){console.log("KEK");var r=this.getPlayerByUserId();r.money-=e.price;var a={name:e.name,id:e.id,price:e.price,position:e.position,color:e.color,mapPosition:e.mapPosition};r.properties.push(a),this.send(r)}}},send:function(t){if(console.log("Send message:"+t),this.stompClient&&this.stompClient.connected){var e=t;this.stompClient.send("/app/changePlayer",JSON.stringify(e),{})}},connect:function(){var t=this;this.socket=new Y.a("/gs-guide-websocket"),this.stompClient=E.a.over(this.socket),this.stompClient.connect({},(function(e){t.connected=!0,console.log(e),t.stompClient.subscribe("/topic/activity",(function(e){t.getPlayers(),t.fetchProperties(),console.log(e)}))}),(function(e){console.log(e),console.log("suck"),t.connected=!1}))},prepProps:function(){this.properties.push({position:0,mapPosition:0,name:"START",price:"Получить 1000",color:"black"});for(var t=1;t<36;t++)this.properties.push({position:-1,mapPosition:t,name:"",price:0,color:"white"})},fetchProperties:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/property");case 2:r=e.sent,t.getProperties(r.data);case 4:case"end":return e.stop()}}),e)})))()},getProperties:function(t){this.incomeData=t;for(var e=0;e<this.users.length;e++)for(var r=this.users[e],a=0;a<r.properties.length;a++)for(var s=r.properties[a],o=0;o<this.incomeData.length;o++){var n=this.incomeData[o];s.id===n.id&&(this.incomeData[o].owner=r.user.name)}for(var i=0;i<this.incomeData.length;i++){var c=this.incomeData[i];console.log(c),this.properties[c.mapPosition]=c}}}},J=W,q=Object(l["a"])(J,D,G,!1,null,"b6d3e15a",null),F=q.exports;p()(q,{VBtn:h["a"],VCard:R["a"],VCardSubtitle:C["a"],VCardText:C["b"],VCardTitle:C["c"],VCol:S["a"],VList:O["a"],VListItem:N["a"],VRow:T["a"]}),a["a"].use(w["a"]);var K=[{path:"/",name:"Main",component:$},{path:"/Game",name:"Game",component:F}],H=new w["a"]({mode:"history",base:"/",routes:K}),z=H,Q=r("f309");a["a"].use(Q["a"]);var X=new Q["a"]({}),Z=r("bc3a"),tt=r.n(Z),et=r("2106"),rt=r.n(et);a["a"].use(rt.a,tt.a),a["a"].config.productionTip=!0,new a["a"]({router:z,vuetify:X,axios:tt.a,render:function(t){return t(b)}}).$mount("#app")}});
//# sourceMappingURL=app.698804b1.js.map